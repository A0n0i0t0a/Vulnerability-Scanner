from Tkinter import *        
import Tkinter as Tkinter
import tkMessageBox as mbox
import os
import time
import sys
from Tkinter import *
import Tkinter as tk
import ttk


def scan():
        count=0
        records = []
        results.delete(0,END)
        ##TRAVERSING DIRECTORIES
        for root, dirs, files in os.walk(variable.get()+":/"):
            for file in files:
                if file.endswith("."+type_.get()):
                        count = count + 1
                        records.append(root + "/" + file)
        if count==0:
                returnItem("No bat file found")
        else:
                for item in records:
                        returnItem(item)
                        
def returnItem(location):
        results.insert(END, location)

def CurSelet(evt):
        try:
            results.get(ACTIVE)
            rec_ = results.curselection()[0]
            print(rec_)
            e = mbox.askokcancel("File Will Be Deleted!", "Are you sure you want to delete this file?", icon='info')
            if e == True:
                    mbox.askokcancel("File deleted !","Successfully Deleted !", icon='info')
        except(Exception), e:
                mbox.askokcancel("Not found","no file to be found", icon='info')
def exit():
        des_ = mbox.askokcancel("Are you Sure!", "Do you want to exit this program?", icon='info')
        if des_ == True:
                master.destroy()
                sys.exit()
                
def sel3():
        None

master=Tkinter.Tk()
frame_color = 'white'
footer_color = "#ddd"
# defining toolbar
def doPrint():
    print('printing..')
    T = Text(master, height=12, width=69)
    T.pack()
    T.insert(END, "Just a text Widget\nin two lines\n")

def about():
    print('printing..')
    T = Text(master, height=12, width=69)
    T.pack()
    T.insert(END, "Just a text Widget\nin two lines\n")
    
    
# Insert a menu bar on the main window
menubar = Menu(master)
master.config(menu=menubar)

# Create a menu button labeled "File" that brings up a menu
filemenu1 = Menu(menubar)
menubar.add_cascade(label='Scan', menu=filemenu1)
filemenu1.add_command(label='Bat Scanner', command=scan)

filemenu2 = Menu(menubar)
menubar.add_cascade(label='Help', menu = filemenu2)
filemenu2.add_command(label='Help', command=doPrint)
filemenu2.add_command(label='About', command=about)

intro = Tkinter.Frame(master, width=450, height = 1, bg =frame_color)
intro.grid(columnspan=15, row=0, column = 0)

intro_label=Label(intro, text="BAT SCANNER", font=("Helvetica", 24) , bg  = frame_color)
intro_label.grid(row=0, column=0, rowspan=15, sticky=S, pady=15)
r = Tkinter.Frame(master, width=450, height = 1 )
r.grid(columnspan=15, row=1, column = 0)

results = Listbox(master)
results.config(width=90)
results.bind('<<ListboxSelect>>',CurSelet)
results.grid(columnspan=15, row=2, column = 0)

s = ttk.Style(master)
s.theme_use('clam')
s.configure('raised.TMenubutton')


#making footer
variable = StringVar(master)
variable.set("F") # default value
w=ttk.OptionMenu(master, variable, "D", "E", "F","H",
                        style = 'raised.TMenubutton')
w.grid(row=3, column = 12)

type_ = StringVar(master)
type_.set("bat") # default value
s=ttk.OptionMenu(master, type_,  "bat","bat","cmd","btm",
                        style = 'raised.TMenubutton')
s.grid(row=3, column = 13)

scanButton=ttk.Button(master, text="BAT file Scan", command=scan )
scanButton.pack(side='left')
scanButton.grid(row=3, column = 14)



#setting main frame
master.wm_title("Strike Screen")
master.configure(bg=frame_color)
master.mainloop()

